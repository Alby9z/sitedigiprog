<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stripe Payment</title>
    <script src="https://js.stripe.com/v3/"></script>
  </head>
  <body>
    <button id="pay-button">Pay</button>
    <script>
      const stripe = Stripe(
        "pk_live_51OPjA7KH5dQs6QYGie0IWt1YKFSzCaS5aD8frQv79xWcf1Y4cHnYAlv7UIYjYqahEsLHv8ZnQJvZDg4SCNuDuQd300qGaoyezp"
      );

      document
        .getElementById("pay-button")
        .addEventListener("click", async () => {
          const response = await fetch("/create-payment-intent", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ amount: 1000 }), // Le montant doit Ãªtre en cents (1000 = 10 USD)
          });
          const data = await response.json();
          const clientSecret = data.clientSecret;

          const result = await stripe.confirmCardPayment(clientSecret, {
            payment_method: {
              card: {
                number: "4242424242424242",
                exp_month: 12,
                exp_year: 2024,
                cvc: "123",
              },
            },
          });

          if (result.error) {
            console.error(result.error.message);
          } else {
            if (result.paymentIntent.status === "succeeded") {
              console.log("Payment succeeded!");
            }
          }
        });
    </script>
  </body>
</html>
